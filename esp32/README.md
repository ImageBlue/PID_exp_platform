大创项目的下位机  

该部分为esp32代码  
连接：推进器-D4 软串口-D23,D22 USB-TTL模块(用户自行选择)-TXD,RXD,5V 串口 MQTT  

*进度  
2023/2/10  完成与uno的软串口通讯测试，完成串口助手的通讯测试，完成MQTT基础通讯测试（未写入），完成推进器的驱动测试（未写入）  
2023/2/13  完成PID算法的移植，完成与上位机的串口初步调试，完成串口指令识别操作，完成推进器控制补充   
2023/3/6  完成MQTT代码移植，完成连接模式检查逻辑的编写，完成PID实机水下测试，完成与上位机包括MQTT和串口的完整通讯测试  


*更新日志  
2023/2/10  
-上传文件  核心代码：esp32_pro  硬件/软件串口模块：usart  软串口SoftwareSerial库：SoftwareSerial.h/.cpp  
完成与UNO的软串口连接通讯，可以接收并处理UNO发送的原始流速数据，真实流速值精确到0.01  
完成硬件串口通讯，此处用的是XCOM串口助手，可以进行发送实时流速值与接收设定的目标流速  
！！！！！注意：流速值指令格式 VELO int ，此处int为至多五位的整形，该值为实时流速值×100后的值，上位机接收时注意处理  
设定目标流速指令格式 VELO int ,此处int为至多三位的整形  
2023/2/13  
-上传文件  PID功能操作：command.ino  自创PID库文件：pid.h/.cpp（创建者[*Silicon-t*](https://github.com/Silicon-t)）  
-更新文件  核心代码：esp32_pro.ino  硬件/软件串口模块：usart.ino  
完成自创PID库的移植，采用C++编写，高度封装，PID流程已打包完成，使用command的run_pid函数即可  
加入推进器的控制，很简单，PWM输出即可  
更新串口指令识别，可以识别指令：手动自动切换、PID参数接收与处理，与上位机实现初步通讯测试  
优化了与UNO的软串口通讯的接收功能，用以解决随机出现的LoadStoreError  
2023/3/6  
-上传文件  MQTT驱动代码：mqtt_pro.ino  
-更新文件  核心代码：esp32_pro.ino  硬件/软件串口模块：usart.ino  
优化了PID参数更改指令的处理流程，解决了PID参数无法正常更改的重大bug  
完成MQTT部分代码移植，可以实现MQTT服务器连接、实时流速上传与上位机指令控制，指令格式与串口完全一致   
！！！！！注意：需要先启动树莓派的MQTT服务器终端，树莓派端使用的是mosquitto库，当然要是自己搭建了MQTT服务器终端  
！！！！！注意：使用时先改代码中mqtt_pro.ino的wifi账号与密码、MQTT服务器的IP与端口号，ESP32与服务器终端务必在一个局域网内   
ESP32启动后会进行连接方式检测，会进行MQTT与串口的轮询检测，对应的Connect指示灯会闪烁  
如果进行串口连接，请打开上位机后等待ESP32识别；如果进行MQTT连接，启动服务器后等待即可  
优化了回传实时流速的指令格式，便于调用，节约资源  
PID算法初步实机实验，算法在跑但跑的不是特别好，将会改进  
！！！！！注意：推进器由外部24V电源供电，请勿连接ESP32的3V3电源，会导致ESP32损坏  
后续计划加入更多的指示灯与连接重置按键，敬请期待下次更新  

