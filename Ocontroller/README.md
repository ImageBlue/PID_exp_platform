# OController上位机

## 简介：

OController是大创项目的上位机，由Qt编写

如您所见，目前已大致完成，最新版本为v1.2.0，可运行程序已在release中放出

上位机具备**有线串口连接**和**无线MQTT连接**功能，在左侧连接模式框中进行参数设置和连接。

实验平台以挡板被水流冲击产生的偏角作为流速的依据，上位机右上角具备绘图区，可以绘制**实时角度-时间**图

上位机右下角用于设置PID参数和目标角度，以及其他控制操作

程序使用了QCharts库进行绘图，使用了QSerialPort和qtmqtt实现串口通信和MQTT通信，并将通信置于多线程中，减少通信与绘图之间的干扰

**注：**

在本地编译源代码需要自行下载并编译Qt的qtmqtt库：https://github.com/qt/qtmqtt

开发上位机的Qt版本为**5.14.2**，与其他版本Qt的函数调用可能有差异

## 通信格式：

| 通信格式                    | 含义                                                         |
| --------------------------- | ------------------------------------------------------------ |
| VELO *int*                  | 向下位机设置目标角度，数据类型**int**                        |
| PID P:*int* I:*int* D:*int* | 向下位机设置PID参数，数据类型为**一位float乘以10转int**，该操作会切换回手动模式 |
| AUTO                        | 启动下位机模糊PID模式，启用后下位机自动设置PID参数           |
